language: rust
rust: beta
sudo: false
env:
  global:
    - RUST_BACKTRACE=1
    - secure: "CmNdUPhvbHTpnwyKPhHEjRN6mM80ACG6YIt35zJWAPrukSqfFx6vns9m3fUFlNSvocCRwrUG9Z5oQRJ2aAsmGgafh3rCpdkU/uYVJVfErGrAEtuWX+S10bZIPb0y9hM28qOYrGBI5xvvZrkZkLPWMF3wfZcVZU1aa1lgwbm1Tp8xltzYU4RLsoebDJaqjFvo6tzqh9wWm8parvsSyoWgiPMa64i1oNRkNXRZuY+gCCc9jpULFK35jlUS6kPTmCaCT55Cp8NnOJKhmil/qYHxdC4R/0lDHIguHBmGPjkuQpeiAeY33nU250BXUtF+q35w3NmDHjWBStnMHsvFUYLTCAPD15rjkrCkoYPGQ+HYxO4EWhlRpbiCv6UV7wfXsxXkvE7RCoMWCct2umI731NpF1+NyCuzfRwfCaSa+XPXxd8s0SBdROFpTUOB+hEN7uXqb1KpqQ0CX7mLs0SCwoxeeqDiwrxTyffbeYCIsmzMJ6qIzq0pey8dj5cdh01xB7K1PrFAmpreg4REC9nWLJAFC/3AVswAz4rIM8nhB0giXexr0/KueDEo9NUMJ1gmVbuJMEM660+Lwi2+cyuZmNcmHFuxraMJVi1CEalZ2gWlkSkAd4o7HrNTn2Vg4V39G986ES7Zf7EITSJ0FU/2L4zzCv9HveA2TXGg5FahkD8ZMro="
addons:
  firefox: latest
  chrome: stable
cache: cargo
install:
  - (test -x $HOME/.cargo/bin/cargo-install-update || cargo install cargo-update)
  - (test -x $HOME/.cargo/bin/cargo-generate || cargo install --vers "^0.2" cargo-generate)
  - cargo install-update -a
  - curl https://rustwasm.github.io/wasm-pack/installer/init.sh -sSf | sh
script:
  - wasm-pack build
  - wasm-pack test --chrome --firefox --headless
before_deploy:
  - (cd www && npm i && npm run-script build)
deploy:
  provider: pages
  skip-cleanup: true
  github-token: $GITHUB_TOKEN
  keep-history: true
  on:
    branch: gh-pages
  local-dir: www/dist
  verbose: true
  deployment-file: true

